<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Cüzdanım ve Altın Fiyatları</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body {
      background-color: #f7f9fb;
      color: #212529;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      padding: 15px;
    }
    .card {
      background-color: #ffffff;
      border: 1px solid #dee2e6;
      border-radius: 15px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.05);
      margin-bottom: 20px;
    }
    .card h2 {
      color: #0d6efd;
    }
    #totalDeposit {
      font-size: 2.5rem;
      font-weight: 700;
      color: #dc3545;
    }
    input[type='number'] {
      width: 100%;
      padding: 6px;
      border-radius: 8px;
      border: 1px solid #ced4da;
      background-color: #fff;
      color: #212529;
    }
    .price-row, .wallet-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 10px;
      border-bottom: 1px solid #f0f0f0;
    }
    .price-row:last-child, .wallet-row:last-child {
      border-bottom: none;
    }
    .title {
      text-align: center;
      margin-bottom: 15px;
      color: #0d6efd;
    }
    .update-time {
      font-size: 0.85rem;
      text-align: center;
      color: #6c757d;
    }
    @media (max-width: 576px) {
      .price-row div, .wallet-row div {
        font-size: 0.9rem;
      }
      #totalDeposit {
        font-size: 2rem;
      }
    }
  </style>
</head>
<body>
  <div class="card text-center p-3">
    <h2>Toplam Mevduat</h2>
    <div id="totalDeposit">0.00 TRY</div>
  </div>

  <div class="card p-3">
    <h2 class="title">Cüzdanım</h2>
    <div id="walletContainer"></div>
  </div>

  <div class="card p-3">
    <h2 class="title">Canlı Altın Fiyatları</h2>
    <div id="priceContainer"></div>
    <div class="update-time" id="updateTime">Veriler yükleniyor...</div>
  </div>

  <script>
    const url = "https://canlipiyasalar.haremaltin.com/tmp/altin.json?dil_kodu=tr";
    const walletItems = {
      "CEYREK_ESKI": 95,
      "ALTIN": 40,
      "AYAR22": 31,
      "YARIM_ESKI": 1,
      "TEK_ESKI": 8,
      "ATA_ESKI": 7,
      "EURTRY": 900,
      "USDTRY": 600,
      "BILEZIK": 115
    };
    let prices = {};

    async function updateTables() {
      try {
        const res = await fetch(url);
        const data = await res.json();
        prices = data.data;

        if (prices["AYAR22"]) {
          prices["BILEZIK"] = {
            alis: prices["AYAR22"].alis,
            satis: prices["AYAR22"].satis
          };
        }

        const walletContainer = document.getElementById("walletContainer");
        const priceContainer = document.getElementById("priceContainer");
        walletContainer.innerHTML = "";
        priceContainer.innerHTML = "";

        for (const item in walletItems) {
          if (prices[item]) {
            priceContainer.innerHTML += `
              <div class="price-row">
                <div><b>${item}</b></div>
                <div>₺${prices[item].alis}</div>
                <div>₺${prices[item].satis}</div>
              </div>
            `;
            walletContainer.innerHTML += `
              <div class="wallet-row">
                <div><b>${item}</b></div>
                <div><input type="number" id="qty_${item}" value="${walletItems[item]}" onchange="calculateTotal()"></div>
              </div>
            `;
          }
        }

        calculateTotal();
        document.getElementById("updateTime").innerText =
          "Son güncelleme: " + new Date().toLocaleTimeString("tr-TR");
      } catch (err) {
        document.getElementById("updateTime").innerText = "Veri alınamadı ❌";
      }
    }

    function calculateTotal() {
      let total = 0;
      for (const item in walletItems) {
        const qty = parseFloat(document.getElementById(`qty_${item}`)?.value) || 0;
        const alis = prices[item] ? parseFloat(prices[item].alis) : 0;
        total += qty * alis;
      }
      document.getElementById("totalDeposit").innerText = total.toFixed(2) + " TRY";
    }

    updateTables();
    setInterval(updateTables, 50000);
  </script>
</body>
</html>

